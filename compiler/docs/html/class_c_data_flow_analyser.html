<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>CP3343: CDataFlowAnalyser Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1-p1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li id="current"><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="classes.html"><span>Alphabetical&nbsp;List</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Data&nbsp;Fields</span></a></li>
  </ul></div>
<h1>CDataFlowAnalyser Class Reference</h1><!-- doxytag: class="CDataFlowAnalyser" --><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_data_flow_analyser.html#76d83d60972fc0e954bbe21647f08a73">CDataFlowAnalyser</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_data_flow_analyser.html#6e50ade1bdb02721c845bbab79b5ec4c">~CDataFlowAnalyser</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_data_flow_analyser.html#5cd0515b418052f0437bcdde37723b34">AnalyseFunction</a> (<a class="el" href="class_c_function_decl_tree_node.html">CFunctionDeclTreeNode</a> **FnDecl, bool DumpDfInfo)</td></tr>

<tr><td colspan="2"><br><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_data_flow_analyser.html#59602469b91b2bbe1175d78d129c0ed6">ComputeUseDefs</a> (<a class="el" href="struct_basic_block__t.html">BasicBlock_t</a> *Block)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_data_flow_analyser.html#c73198347551affca94030eaa6471018">ComputeLivenessInfo</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_data_flow_analyser.html#63fc3cd4b2d3ac00e3515d330e8697c0">ComputeLiveOutForBlock</a> (<a class="el" href="struct_basic_block__t.html">BasicBlock_t</a> *Block)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_data_flow_analyser.html#f8990fc851750dd23bcefcb9c609b9dc">ComputeLiveInForBlock</a> (<a class="el" href="struct_basic_block__t.html">BasicBlock_t</a> *Block)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_data_flow_analyser.html#d9ffc0bb14b7fd32bab9796aa1f6e502">DumpDataFlowInformation</a> (list&lt; <a class="el" href="struct_basic_block__t.html">BasicBlock_t</a> * &gt; &amp;Graph, string FuncName)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_data_flow_analyser.html#da5b393752c257d1df8c7058052d41ee">ScanStmtForUses</a> (<a class="el" href="class_c_tree_node.html">CTreeNode</a> *Stmt, <a class="el" href="struct_basic_block__t.html">BasicBlock_t</a> *Block)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_data_flow_analyser.html#0cfbc0123716175456e3ee3bf9c6c84e">ScanIdentifierNodeForUses</a> (<a class="el" href="class_c_tree_node.html">CTreeNode</a> *Id, <a class="el" href="struct_basic_block__t.html">BasicBlock_t</a> *Block)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_data_flow_analyser.html#8f7d78f5ba002fa49f607774423afae4">CompareSets</a> (set&lt; <a class="el" href="class_c_identifier_tree_node.html">CIdentifierTreeNode</a> *, <a class="el" href="struct_comp_identifiers.html">CompIdentifiers</a> &gt; &amp;SetOne, set&lt; <a class="el" href="class_c_identifier_tree_node.html">CIdentifierTreeNode</a> *, <a class="el" href="struct_comp_identifiers.html">CompIdentifiers</a> &gt; &amp;SetTwo)</td></tr>

<tr><td colspan="2"><br><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_data_flow_analyser.html#ae2d0f7f1db2bb63ffabdadb4572b35c">m_CurrStmtNo</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">deque&lt; <a class="el" href="struct_basic_block__t.html">BasicBlock_t</a> * &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_data_flow_analyser.html#421587197185c3b7f5c092308c4607c4">m_Worklist</a></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Implementation of a worklist based solver for the use-defs and liveness dataflow equations. The class operates a single function at a time and works but continually solving the equations for each block in the functions CFG until a solution is converged upon. 
<p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="76d83d60972fc0e954bbe21647f08a73"></a><!-- doxytag: member="CDataFlowAnalyser::CDataFlowAnalyser" ref="76d83d60972fc0e954bbe21647f08a73" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CDataFlowAnalyser::CDataFlowAnalyser           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="6e50ade1bdb02721c845bbab79b5ec4c"></a><!-- doxytag: member="CDataFlowAnalyser::~CDataFlowAnalyser" ref="6e50ade1bdb02721c845bbab79b5ec4c" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CDataFlowAnalyser::~CDataFlowAnalyser           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="5cd0515b418052f0437bcdde37723b34"></a><!-- doxytag: member="CDataFlowAnalyser::AnalyseFunction" ref="5cd0515b418052f0437bcdde37723b34" args="(CFunctionDeclTreeNode **FnDecl, bool DumpDfInfo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CDataFlowAnalyser::AnalyseFunction           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_c_function_decl_tree_node.html">CFunctionDeclTreeNode</a> **&nbsp;</td>
          <td class="paramname"> <em>FnDecl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>DumpDfInfo</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Perform data flow analysis for a given function, solving the use-defs and liveness equations. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>FnDecl</em>&nbsp;</td><td>Function decl whose CFG we're analysing. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>DumpDfInfo</em>&nbsp;</td><td>True if we should output the computed dataflow information to a dump file. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="59602469b91b2bbe1175d78d129c0ed6"></a><!-- doxytag: member="CDataFlowAnalyser::ComputeUseDefs" ref="59602469b91b2bbe1175d78d129c0ed6" args="(BasicBlock_t *Block)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CDataFlowAnalyser::ComputeUseDefs           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_basic_block__t.html">BasicBlock_t</a> *&nbsp;</td>
          <td class="paramname"> <em>Block</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute the sets of values which are used and defined for a basic block. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Block</em>&nbsp;</td><td>Basic block we're looking for use-defs in. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="c73198347551affca94030eaa6471018"></a><!-- doxytag: member="CDataFlowAnalyser::ComputeLivenessInfo" ref="c73198347551affca94030eaa6471018" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CDataFlowAnalyser::ComputeLivenessInfo           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute liveness information for the current basic blocks in the worklist which will be the contents of the CFG for the function passed to AnalyseFunction. 
</div>
</div><p>
<a class="anchor" name="63fc3cd4b2d3ac00e3515d330e8697c0"></a><!-- doxytag: member="CDataFlowAnalyser::ComputeLiveOutForBlock" ref="63fc3cd4b2d3ac00e3515d330e8697c0" args="(BasicBlock_t *Block)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CDataFlowAnalyser::ComputeLiveOutForBlock           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_basic_block__t.html">BasicBlock_t</a> *&nbsp;</td>
          <td class="paramname"> <em>Block</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Subroutine of ComputeLivenessInfo, computes the set of values which are live in exit for a basic block. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Block</em>&nbsp;</td><td>Basic block we're processing. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>True if the liveout information for Block has been altered, false if nothing changed. </dd></dl>

</div>
</div><p>
<a class="anchor" name="f8990fc851750dd23bcefcb9c609b9dc"></a><!-- doxytag: member="CDataFlowAnalyser::ComputeLiveInForBlock" ref="f8990fc851750dd23bcefcb9c609b9dc" args="(BasicBlock_t *Block)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CDataFlowAnalyser::ComputeLiveInForBlock           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_basic_block__t.html">BasicBlock_t</a> *&nbsp;</td>
          <td class="paramname"> <em>Block</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Subroutine of ComputeLivenessInfo, computes the set of values which are live on entry for a basic block. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Block</em>&nbsp;</td><td>Basic block we're processing. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>True if the live in information has been adjusted, false if nothing changed. </dd></dl>

</div>
</div><p>
<a class="anchor" name="d9ffc0bb14b7fd32bab9796aa1f6e502"></a><!-- doxytag: member="CDataFlowAnalyser::DumpDataFlowInformation" ref="d9ffc0bb14b7fd32bab9796aa1f6e502" args="(list&lt; BasicBlock_t * &gt; &amp;Graph, string FuncName)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CDataFlowAnalyser::DumpDataFlowInformation           </td>
          <td>(</td>
          <td class="paramtype">list&lt; <a class="el" href="struct_basic_block__t.html">BasicBlock_t</a> * &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>Graph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&nbsp;</td>
          <td class="paramname"> <em>FuncName</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Dump the computed data flow information to file. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Graph</em>&nbsp;</td><td>Control flow graph for a single function whose dataflow contents we're dumping to a file. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FuncName</em>&nbsp;</td><td>Name of the function whose information we're outputting. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="da5b393752c257d1df8c7058052d41ee"></a><!-- doxytag: member="CDataFlowAnalyser::ScanStmtForUses" ref="da5b393752c257d1df8c7058052d41ee" args="(CTreeNode *Stmt, BasicBlock_t *Block)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CDataFlowAnalyser::ScanStmtForUses           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_c_tree_node.html">CTreeNode</a> *&nbsp;</td>
          <td class="paramname"> <em>Stmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_basic_block__t.html">BasicBlock_t</a> *&nbsp;</td>
          <td class="paramname"> <em>Block</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Scan a tree node for var uses, adding any found to the "uses" set of the basic block. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Stmt</em>&nbsp;</td><td>Generic stmt we're looking for uses in. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Block</em>&nbsp;</td><td>Basic block we're scanning for uses. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="0cfbc0123716175456e3ee3bf9c6c84e"></a><!-- doxytag: member="CDataFlowAnalyser::ScanIdentifierNodeForUses" ref="0cfbc0123716175456e3ee3bf9c6c84e" args="(CTreeNode *Id, BasicBlock_t *Block)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CDataFlowAnalyser::ScanIdentifierNodeForUses           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_c_tree_node.html">CTreeNode</a> *&nbsp;</td>
          <td class="paramname"> <em>Id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_basic_block__t.html">BasicBlock_t</a> *&nbsp;</td>
          <td class="paramname"> <em>Block</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Subroutine of ScanStmtForUses to specifically handle identifier tree nodes as they have far greater potential for referencing other values in the program. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Id</em>&nbsp;</td><td>Identifier node we're looking at for uses of other variables. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Block</em>&nbsp;</td><td>Current basic block being processed where we'll add any uses to. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="8f7d78f5ba002fa49f607774423afae4"></a><!-- doxytag: member="CDataFlowAnalyser::CompareSets" ref="8f7d78f5ba002fa49f607774423afae4" args="(set&lt; CIdentifierTreeNode *, CompIdentifiers &gt; &amp;SetOne, set&lt; CIdentifierTreeNode *, CompIdentifiers &gt; &amp;SetTwo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CDataFlowAnalyser::CompareSets           </td>
          <td>(</td>
          <td class="paramtype">set&lt; <a class="el" href="class_c_identifier_tree_node.html">CIdentifierTreeNode</a> *, <a class="el" href="struct_comp_identifiers.html">CompIdentifiers</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>SetOne</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">set&lt; <a class="el" href="class_c_identifier_tree_node.html">CIdentifierTreeNode</a> *, <a class="el" href="struct_comp_identifiers.html">CompIdentifiers</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>SetTwo</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Helper function to compare two sets for equality. Although the std::set container allows a functor object to be used when creating instances, we can have the situation where there are two different identifier tree nodes which refer to the same values. In this situation using the std algorithm such as "includes" doesn't work so we have to compare the sets manually. This approach fixes a bug in the solver where we hit an infinite loop as we kept thinking the dataflow sets had changed when in fact they had converged on a solution. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>SetOne</em>&nbsp;</td><td>The first set we're comparing with. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>SetTwo</em>&nbsp;</td><td>The set we're comparing the first one with. </td></tr>
  </table>
</dl>

</div>
</div><p>
<hr><h2>Field Documentation</h2>
<a class="anchor" name="ae2d0f7f1db2bb63ffabdadb4572b35c"></a><!-- doxytag: member="CDataFlowAnalyser::m_CurrStmtNo" ref="ae2d0f7f1db2bb63ffabdadb4572b35c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="class_c_data_flow_analyser.html#ae2d0f7f1db2bb63ffabdadb4572b35c">CDataFlowAnalyser::m_CurrStmtNo</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
When computing definitions the current stmt we're looking at will be stored here so it can be associated with each def as we find them 
</div>
</div><p>
<a class="anchor" name="421587197185c3b7f5c092308c4607c4"></a><!-- doxytag: member="CDataFlowAnalyser::m_Worklist" ref="421587197185c3b7f5c092308c4607c4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">deque&lt;<a class="el" href="struct_basic_block__t.html">BasicBlock_t</a>*&gt; <a class="el" href="class_c_data_flow_analyser.html#421587197185c3b7f5c092308c4607c4">CDataFlowAnalyser::m_Worklist</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Worklist of remaining blocks to process. 
</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_c_data_flow_analyser_8h.html">CDataFlowAnalyser.h</a><li><a class="el" href="_c_data_flow_analyser_8cpp.html">CDataFlowAnalyser.cpp</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Wed May 16 12:56:51 2007 for CP3343 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1-p1 </small></address>
</body>
</html>
